<html>
    <title>Dungeon Taptapir</title>
<body>
<script>
    //To deal with floating point numbers
    var _cf = (function() {
        function _shift(x) {
          var parts = x.toString().split('.');
          return (parts.length < 2) ? 1 : Math.pow(10, parts[1].length);
        }
        return function() { 
          return Array.prototype.reduce.call(arguments, function (prev, next) { return prev === undefined || next === undefined ? undefined : Math.max(prev, _shift (next)); }, -Infinity);
        };
      })();
      
      Math.a = function () {
        var f = _cf.apply(null, arguments); if(f === undefined) return undefined;
        function cb(x, y, i, o) { return x + f * y; }
        return Array.prototype.reduce.call(arguments, cb, 0) / f;
      };
      
      Math.s = function (l,r) { var f = _cf(l,r); return (l * f - r * f) / f; };
      
      Math.m = function () {
        var f = _cf.apply(null, arguments);
        function cb(x, y, i, o) { return (x*f) * (y*f) / (f * f); }
        return Array.prototype.reduce.call(arguments, cb, 1);
      };
      
      Math.d = function (l,r) { var f = _cf(l,r); return (l * f) / (r * f); };
</script>
    <script src="taptapir/taptapir.js"></script>
<script type="text/sunsnake">

#Global Functions
set_orientation('horizontal')
set_window_color('gray')
set_background_color('black')
ASSETS_FOLDER='assets/'
distance_2d = distance
environment = []

moved=False


def update():
    #Smooth Follow
    camera.xy = player.xy

def input(key):
    #Collision Detection
    if key == 'w':
        for object in environment:
            if player.x == object.x:
                if Math.a(player.y, 0.1) == object.y:
                    ;
                else:
                    if not moved:
                        player.y = Math.a(player.y, 0.1)
                        moved=True
            else:
                if not moved:
                    player.y = Math.a(player.y, 0.1)
                    moved=True
        moved=False
    if key == 'a':
        for object in environment:
            if Math.s(player.x, 0.1) == object.x:
                if player.y == object.y:
                    ;
                else:
                    if not moved:
                        player.x = Math.s(player.x, 0.1)
                        moved=True
            else:
                if not moved:
                    player.x = Math.s(player.x, 0.1)
                    moved=True
        moved=False
    if key == 's':
        for object in environment:
            if player.x == object.x:
                if Math.s(player.y, 0.1) == object.y:
                    ;
                else:
                    if not moved:
                        player.y = Math.s(player.y, 0.1)
                        moved=True
            else:
                if not moved:
                    player.y = Math.s(player.y, 0.1)
                    moved=True
        moved=False
    if key == 'd':
        for object in environment:
            if Math.a(player.x, 0.1) == object.x:
                if player.y == object.y:
                    ;
                else:
                    if not moved:
                        player.x = Math.a(player.x, 0.1)
                        moved=True
            else:
                if not moved:
                    player.x = Math.a(player.x, 0.1)
                    moved=True
        moved=False
player = Entity(scale=.1,speed=0.1,canMove=False)
box = Entity(scale=.1,x=.1,y=.1, color=color.blue)
environment.append(box)

</script>
<script src="taptapir/sunsnake_compiler.js"></script>
</body>
</html>